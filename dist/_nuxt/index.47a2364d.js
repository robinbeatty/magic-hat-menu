import{_ as z}from"./nuxt-link.8f3c6f64.js";import{n as G,u as K,q as L,s as W,c,v as y,a as n,t as p,F as k,x as T,b as A,w as F,y as w,d as D,o as i,z as Y}from"./entry.12a2ba6e.js";const E=o=>o?o.normalize("NFD").replace(/[\u0300-\u036F]/g,""):"",P=o=>o.charAt(0).toUpperCase()+o.slice(1),U=o=>{if(!o)return null;const l=o.replaceAll(`
<p>`,"<p>").replaceAll("	","").replaceAll("<p></p>","").replaceAll("<br /></p>","</p>");return E(l)},J=o=>o.replace("https://app.hl.is",""),Q=o=>{var l;if(o){const _=(l=U(J(o)))==null?void 0:l.replace("<p>",'<p class="redactor">');if(_)return _}return""},X=o=>[...new Set(o)],Z={class:"font-mono p-3 md:p-10 bg-white"},ee={key:0,class:"w-full lg:max-h-screen lg:flex-center"},te={class:"text-center w-full py-5"},ne=n("h1",{class:"xl:text-5xl"},"Magic Hat",-1),se=n("div",{class:"uppercase text-lg md:text-3xl xl:text-2xl mt-3"}," Coffee \\ Kitchen \\ Events ",-1),ae={class:"uppercase text-lg mt-5"},oe={class:"border-y-2 border-black w-full min-h-6"},re={class:"uppercase text-sm text-center p-3"},ce={class:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-x-12 text-left"},ie={class:"text-2xl leading-none"},le={key:0,class:"text-xs"},de={class:"grid grid-cols-1 gap-5 mt-5"},ue={class:"max-w-lg space-y-1"},pe={class:"text-lg leading-tight uppercase"},ge={class:"mr-2 font-normal font-mono inline"},me={class:"text-sm lowercase"},ye={class:"leading-none"},_e={key:0},he={class:"text-2xs"},xe={key:0},fe={key:1,class:"text-2xs"},ve={class:"text-sm justify-end items-baseline"},we=n("div",{class:"hidden xl:block col-span-2"},null,-1),De={key:0,class:"md:col-span-2 xl:col-span-2 space-y-3"},Se=["innerHTML"],be={key:1,class:"h-screen w-screen flex-center"},ke={class:"space-y-5"},Te={class:"text-2xl"},Ce=n("br",null,null,-1),Le=G({__name:"index",async setup(o){var N;let l,_;const{$craft:C}=Y(),S=K(),{data:b}=([l,_]=L(()=>C.query.menus()),l=await l,_(),l),{data:f}=([l,_]=L(()=>C.query.globalSet.magicHatMenu()),l=await l,_(),l),M=e=>{const t=e.map(d=>new Date(d.date).getTime()),a=Math.max(...t);return new Date(a).toISOString().split("T")[0]};let x=(()=>{const e=new Date,t=String(e.getDate()).padStart(2,"0"),a=String(e.getMonth()+1).padStart(2,"0");return e.getFullYear().toString()+"-"+a.toString()+"-"+t.toString()})();const H=e=>!isNaN(Date.parse(e)),q=e=>{const t=e.split("-");return new Date(parseInt(t[2]),parseInt(t[1])-1,parseInt(t[0]))};if(S.query.date){let e=new Date(S.query.date);H(S.query.date)||(console.warn("Invalid date provided in query string, reformatting..."),e=q(S.query.date));const t=String(e.getDate()).padStart(2,"0"),a=String(e.getMonth()+1).padStart(2,"0");x=e.getFullYear().toString()+"-"+a.toString()+"-"+t.toString()}else x=M(b.value||[]);const I=e=>{const t=e.split("-");let a=t[0],d=t[1],u=t[2];return t[2].length>2&&(a=t[2],u=t[0]),new Date(`${a}-${d}-${u}`).toLocaleDateString("en-GB",{weekday:"long",year:"numeric",month:"long",day:"numeric"})},v=((N=b.value)==null?void 0:N.find(e=>{const t=new Date(e.date).getTime(),a=new Date(x).getTime();return t===a}))||null,$=M(b.value||[]),B=e=>{var u,s;const a=(u=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][new Date(e).getDay()])==null?void 0:u.toLowerCase(),d=(s=f.value)==null?void 0:s.openingHours.find(r=>r.day==a);return d?{day:P(a),open:new Date(d.openFrom).toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),close:new Date(d.openTo).toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"})}:null},O=e=>{const t=B(e);return t?`Kitchen Open ${t.open} - ${t.close}`:"Kitchen Closed"},R=e=>e.toLowerCase()=="vegan"?"ve":e.toLowerCase()=="vegetarian"?"v":e,V=e=>`Contains ${e.map(t=>t.title).join(", ")}`,j=W(()=>{var u;if(!v)return[];const e=((u=f.value)==null?void 0:u.menuItems)||[],t=s=>s.length?s[0].title:"",a=(s,r)=>{var h;return((h=s.menuItems.map(m=>m.menu).flat().find(m=>m.title==r))==null?void 0:h.description)||""};return X([...v.menuItems.map(s=>t(s.menu)),...e.map(s=>t(s.menu))].flat()).filter(s=>s.length).map(s=>{var m;const r=v.menuItems.filter(g=>t(g.menu)==s).map(g=>({...g,type:"menu"})),h=((m=f.value)==null?void 0:m.menuItems.filter(g=>t(g.menu)==s).map(g=>({...g,type:"persistent"})))||[];return{menuType:s,menuDescription:a(v,s),items:[...r,...h]}})});return(e,t)=>{var d,u;const a=z;return i(),c("div",Z,[y(v)?(i(),c("main",ee,[n("div",null,[n("div",te,[ne,se,n("div",ae,p(O(y(x))),1)]),n("div",oe,[n("div",re,p(I(y(x))),1)]),n("section",ce,[(i(!0),c(k,null,T(y(j),s=>(i(),c("div",{key:s.menuType,class:"border-b-2 border-black pt-5 pb-6 xl:pt-10 xl:pb-10"},[n("h2",ie,[D(p(s.menuType)+" ",1),s.menuDescription?(i(),c("span",le,p(s.menuDescription),1)):w("",!0)]),n("div",de,[(i(!0),c(k,null,T(s.items,r=>{var h,m;return i(),c("div",{key:r.id,class:"flex gap-5 justify-between items-baseline"},[n("div",ue,[n("div",pe,[n("h4",ge,p(r.itemName),1),(i(!0),c(k,null,T(r.dietaryCompliance,g=>(i(),c("span",{key:g,class:"text-2xs uppercase rounded-sm border border-black font-medium font-sans size-5 text-black inline-flex items-center justify-center leading-[0] align-top mt-0"},[n("span",null,p(R(g)),1)]))),128))]),n("div",me,p(r.description),1),n("div",ye,[r.allergens.length?(i(),c("span",_e,[n("span",he,p(V(r.allergens)),1),(h=r.notes)!=null&&h.length?(i(),c("br",xe)):w("",!0),(m=r.notes)!=null&&m.length?(i(),c("span",fe,p(r.notes),1)):w("",!0)])):w("",!0)])]),n("div",ve,p(r.price),1)])}),128))])]))),128)),we,(d=y(f))!=null&&d.body?(i(),c("div",De,[n("div",{innerHTML:y(Q)((u=y(f))==null?void 0:u.body),class:"mt-5 space-y-3 text-xs [&>h2]:text-2xl"},null,8,Se),n("div",null,[A(a,{to:"https://www.themagichatcafe.co.uk/",external:!0,class:"underline"},{default:F(()=>[D("themagichatcafe.co.uk")]),_:1})])])):w("",!0)])])])):(i(),c("section",be,[n("div",ke,[n("div",Te,[D("No menu found for "),Ce,D(p(I(y(x))),1)]),n("div",null,[A(a,{to:`/?date=${y($)}`,external:!0,class:"button border-2 border-black hover:text-white hover:bg-black"},{default:F(()=>[D("View most recent menu")]),_:1},8,["to"])])])]))])}}});export{Le as default};
